---
path: "hotmail-email-filtering-and-spf"
title: "Hotmail Email Filtering and SPF"
description: "Hotmail Email Server Filters will accept your outgoing emails if you add a Sender Policy Framework (SPF) record to your DNS records."
tags: 
  - "Email"
  - "Linux & Server Admin"
date: "2008-03-01T23:00:00.000Z"
draft: false
category: "test"
layout: "post"
---

"Changing email encoding":http://marcgrabanski.com/article/104/CakePHP-Email-Encoding solved many of my email sending woes, but hotmail was still refusing to accept my outgoing emails. In researching email acceptance, I found out that many people are having issues with hotmail silently refusing their emails. This has even resulted in a "petition to remove":http://www.petitiononline.com/notsmart/ Microsoft's intense spam filtering system that blocks legit emails (including mine). That aside, I did some research to find someone with a solution. I started my search at my web host, "Media Temple":http://www.mediatemple.net/go/order/?refdom=marcgrabanski.com , and found an article on "hotmail and yahoo email spam flagging issues":http://kb.mediatemple.net/article.php?id=709 where they recommended using aSPFrecord. Next, I found someone who this solved his "hotmail email sending issues":http://www.innovation-station.net/archives/2007/03/29/hotmail-and-my-spf-nightmare/ with thisSPFrecord. ThisSPFmust be the magic bullet, I thought. What is a SPF record you say? Before I get into that, I want to give you some information that was helpful for me to understand why my email was getting dropped by hotmail.

## Introduction to DNS Records DNS records play a huge role in the, "I'm not spam" game. Let me explain the basics. When you register a domain you have to set your name servers in your domain control panel. This usually looks like: NS1.DOMAIN.COM and NS2.DOMAIN.COM. These records would give the company who owns DOMAIN.COM rights to your DNS records. Your DNS records control everything associated with your domain and can be changed via your domain control panel. In your control panel, you will find something called A or CNAME records. These records point to your web server. In my case, my control panel shows A records as: **.domain.com, and domain.com point to the IP address of my web server.
!http://marcgrabanski.com/img/bread-butter.jpg!
*Look at A or CNAME records as your bread and butter records that tell you where your server and files are.* The other basic type of record is your MX records. The MX records point to your incoming mail server(s).
!http://marcgrabanski.com/img/email_keys.jpg!
*When you think of MX records, think of email.* Some registrars, like Yahoo, only allow you to edit these three basic types of DNS records: your name servers, MX records and A/CNAME records. This works in most cases (consumer and small business), but I found they will not allow you add any custom records to your DNS information such as TXT orSPF. My original plan was to use Yahoo as my mail server, but they won't let you set thisSPFrecord, so that means Yahoo (**erhm** Microsoft's pet) just lost my business.

## So what isSPF? The "Sender Policy Framework":http://en.wikipedia.org/wiki/Sender_Policy_Framework is used to tell mail servers that your outgoing mail as legit. As far as I can tell, it is the key to unlocking hotmail to receive your outgoing emails in the midst of the spam wars. To add thisSPFrecord, it is pretty straight forward. Your web host should know and be able to help you with this - my web host provides an article on "setting up anSPFrecord":http://kb.mediatemple.net/article.php?id=658 . Let me give you an example. I want to tell mail servers that it is okay if email originates from my dedicated web server, which has IP address 555.555.555.555. So, I would specify this by adding a record to my DNS of type TXT that looks like: @v=spf1 a mx ip4:555.555.555.555 ~all@ "v=spf1" says that it is a Sender Policy Framework record. "a" and "mx" states that the records come from my original domain name. And finally the, "ip4:555.555.555.555" is what really matters - it states sending mail from the server with that IP address, 555.555.555.555 is acceptable. You can generate your own record with the "SPF Setup Wizard":http://old.openspf.org/wizard.html. You still have to know the basics of DNS though, which is why I explained them earlier. In the end, make sure that the company you point your name servers to allows you to add a custom SPF/TXT record. It is worth the time to understand this if you plan on sending automated emails to a wide audience. You don't want your users to ditch using your application because they are waiting for an email for 10 minutes with no response.